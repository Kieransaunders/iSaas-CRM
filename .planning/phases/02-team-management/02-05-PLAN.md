---
phase: 02-team-management
plan: 05
type: execute
wave: 4
depends_on: ["02-01", "02-02", "02-03", "02-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Admin can invite a staff user and see them in the Pending tab"
    - "Admin can invite a client user linked to a customer"
    - "Admin can revoke or resend a pending invitation"
    - "Accepted invitation creates user in the system with correct role"
    - "Admin can view all org members in the team table"
    - "Admin can remove a user and they are marked as removed"
    - "Admin can restore a removed user"
    - "Admin can assign and unassign staff to customers from customer detail"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete team management flow end-to-end: invitation, acceptance, team listing, member management, and staff assignment.

Purpose: Ensures all pieces (schema, backend, webhook, UI) work together as a cohesive feature before marking Phase 2 complete.
Output: Verified working team management system.
</objective>

<execution_context>
@/Users/boss/.claude/get-shit-done/workflows/execute-plan.md
@/Users/boss/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-team-management/02-01-SUMMARY.md
@.planning/phases/02-team-management/02-02-SUMMARY.md
@.planning/phases/02-team-management/02-03-SUMMARY.md
@.planning/phases/02-team-management/02-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete team management system for Phase 2:
1. Invitation backend: send, revoke, resend invitations via WorkOS API
2. Staff assignment: assign/unassign staff to customers from customer detail page
3. WorkOS webhook handler: processes invitation.accepted events, syncs user data
4. User management: soft-delete (remove) and restore org members
5. Team page UI: tabbed table (All/Staff/Clients/Pending) with invite dialog
  </what-built>
  <how-to-verify>
**Test 1: Invite a Staff User**
1. Navigate to /team
2. Click "Invite Member" button (top-right)
3. Enter an email address, select "Staff" role
4. Click "Send Invite"
5. Verify: invite appears in the Pending tab with correct email and role

**Test 2: Invite a Client User**
1. Click "Invite Member" again
2. Enter a different email, select "Client" role
3. Verify: Customer dropdown appears
4. Select a customer from the dropdown
5. Click "Send Invite"
6. Verify: invite appears in Pending tab with email, role, and customer name

**Test 3: Manage Pending Invitations**
1. Go to the Pending tab
2. Click "Resend" on an invitation — verify no error
3. Click "Revoke" on an invitation — verify it disappears from the list

**Test 4: Team Member Table**
1. Go to the All tab
2. Verify: your admin user appears in the list
3. Verify: tab counts match the number of members shown

**Test 5: Remove and Restore User** (if test users exist)
1. If there are other active users, click "Remove" on one
2. Verify: confirmation dialog appears
3. Confirm removal
4. Verify: user shows as "Removed" status or disappears from active list
5. Find the removed user and click "Restore"
6. Verify: user is active again

**Test 6: Staff Assignment**
1. Navigate to a customer detail page (click any customer)
2. Verify: "Assigned Staff" card is visible (admin only)
3. If staff users exist, use the dropdown to assign one
4. Verify: staff member appears in the assigned list
5. Click the X button to unassign
6. Verify: staff member removed from assigned list

**Test 7: Tab Counts**
1. Go back to /team
2. Verify tab counts update after invite/remove actions
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues found.</resume-signal>
</task>

</tasks>

<verification>
All 7 test scenarios pass without errors. Team management is functional end-to-end.
</verification>

<success_criteria>
- Invite flow works: email entered, role selected, invitation sent
- Pending invitations visible and manageable (resend, revoke)
- Team table shows members with correct roles and statuses
- Remove/restore cycle works with confirmation dialog
- Staff assignment works from customer detail page
- Tab counts reflect real data
- No console errors during any flow
</success_criteria>

<output>
After completion, create `.planning/phases/02-team-management/02-05-SUMMARY.md`
</output>
